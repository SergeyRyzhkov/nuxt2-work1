<template>
  <div class="relative">
    <div class="relative top-0 z-50 w-screen xl:absolute">
      <div class="xl:mt-82 container mb-40 mt-40 mr-20 flex xl:mb-0">
        <div class="mr-30 xl:ml-auto 2xl:mr-[300px]">
          <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M8.66759 12.4609C8.66759 10.3511 10.3834 8.64032 12.5005 8.64032C14.6176 8.64032 16.3343 10.3511 16.3343 12.4609C16.3343 14.5708 14.6176 16.2816 12.5005 16.2816C10.3834 16.2816 8.66759 14.5708 8.66759 12.4609ZM6.59511 12.4609C6.59511 15.7113 9.23893 18.346 12.5005 18.346C15.762 18.346 18.4058 15.7113 18.4058 12.4609C18.4058 9.21062 15.762 6.57588 12.5005 6.57588C9.23893 6.57588 6.59511 9.21062 6.59511 12.4609ZM17.2595 6.34254C17.2594 6.61455 17.3403 6.88048 17.4918 7.10671C17.6434 7.33294 17.8588 7.50931 18.111 7.6135C18.3631 7.7177 18.6406 7.74504 18.9083 7.69208C19.176 7.63912 19.422 7.50823 19.615 7.31597C19.8081 7.12371 19.9397 6.8787 19.993 6.61194C20.0464 6.34518 20.0192 6.06863 19.9148 5.81729C19.8105 5.56594 19.6337 5.35108 19.4068 5.19986C19.1799 5.04865 18.9131 4.96789 18.6401 4.96778H18.6396C18.2737 4.96795 17.9229 5.11282 17.6641 5.37059C17.4054 5.62836 17.2599 5.97793 17.2595 6.34254ZM7.85427 21.7899C6.73303 21.739 6.12359 21.5529 5.71859 21.3956C5.18166 21.1873 4.79856 20.9392 4.39576 20.5383C3.99297 20.1375 3.74364 19.7561 3.53553 19.221C3.37765 18.8175 3.19088 18.21 3.13991 17.0926C3.08416 15.8845 3.07303 15.5216 3.07303 12.461C3.07303 9.40041 3.08508 9.03852 3.13991 7.82943C3.19098 6.71204 3.37912 6.10571 3.53553 5.70109C3.74456 5.166 3.99352 4.78422 4.39576 4.38281C4.798 3.9814 5.18074 3.73293 5.71859 3.52553C6.12341 3.3682 6.73303 3.18207 7.85427 3.13128C9.06651 3.07571 9.43067 3.06462 12.5005 3.06462C15.5703 3.06462 15.9348 3.07663 17.148 3.13128C18.2693 3.18216 18.8777 3.36966 19.2837 3.52553C19.8206 3.73293 20.2037 3.98195 20.6065 4.38281C21.0093 4.78367 21.2577 5.166 21.4668 5.70109C21.6246 6.10452 21.8114 6.71204 21.8624 7.82943C21.9181 9.03852 21.9293 9.40041 21.9293 12.461C21.9293 15.5216 21.9181 15.8835 21.8624 17.0926C21.8113 18.21 21.6236 18.8174 21.4668 19.221C21.2577 19.7561 21.0088 20.1378 20.6065 20.5383C20.2043 20.9388 19.8206 21.1873 19.2837 21.3956C18.8789 21.5529 18.2693 21.7391 17.148 21.7899C15.9358 21.8454 15.5716 21.8565 12.5005 21.8565C9.42929 21.8565 9.06615 21.8454 7.85427 21.7899ZM7.75905 1.06941C6.53476 1.12497 5.69817 1.31843 4.96757 1.60175C4.21093 1.89432 3.5704 2.28683 2.93033 2.9237C2.29026 3.56056 1.8974 4.19989 1.60382 4.95393C1.31953 5.68248 1.1254 6.51574 1.06965 7.73582C1.01297 8.95783 1 9.34851 1 12.4609C1 15.5734 1.01297 15.964 1.06965 17.1861C1.1254 18.4062 1.31953 19.2394 1.60382 19.9679C1.8974 20.7215 2.29035 21.3616 2.93033 21.9982C3.57031 22.6348 4.21093 23.0267 4.96757 23.3201C5.69955 23.6034 6.53476 23.7969 7.75905 23.8525C8.98592 23.908 9.3773 23.9219 12.5005 23.9219C15.6236 23.9219 16.0156 23.9089 17.2419 23.8525C18.4663 23.7969 19.3023 23.6034 20.0334 23.3201C20.7895 23.0267 21.4305 22.635 22.0706 21.9982C22.7107 21.3613 23.1027 20.7215 23.3971 19.9679C23.6814 19.2394 23.8764 18.4061 23.9313 17.1861C23.987 15.9631 24 15.5734 24 12.4609C24 9.34851 23.987 8.95783 23.9313 7.73582C23.8755 6.51565 23.6814 5.68202 23.3971 4.95393C23.1027 4.20035 22.7096 3.56157 22.0706 2.9237C21.4315 2.28583 20.7895 1.89432 20.0343 1.60175C19.3023 1.31843 18.4662 1.12405 17.2428 1.06941C16.0166 1.01384 15.6245 1 12.5014 1C9.37822 1 8.98592 1.01293 7.75905 1.06941Z"
              fill="#131313"
            />
          </svg>
          <h2 class="mt-35 font-compact text-43">
            Заходите к нам <br />
            в <a class="text-secondary" :href="instagrammUrl" target="_blank">@kaypro_moscow</a>
          </h2>
        </div>
      </div>
    </div>
    <LazyBaseSwiper
      :slides="fotoList"
      :pagination="false"
      :arrows="false"
      :settings="sliderSettings"
      container-classes="insta-swiper-container"
    >
      <template #slide="{ slide }">
        <img :src="slide.url" class="h-307 w-full object-cover xl:h-full" alt=" " width="307" height="307" />
      </template>
    </LazyBaseSwiper>
  </div>
</template>

<script lang="ts">
import { Vue, Component, Prop } from "nuxt-property-decorator";
import AppSettings from "../models/AppSettings";
import { SettingService } from "../SettingService";

@Component
export default class InstagramBlock extends Vue {
  @Prop()
  fotoList: { url: string }[];

  settings: AppSettings = new AppSettings();

  async fetch() {
    this.settings = await this.$serviceLocator.getService(SettingService).getAppSetting();
  }

  get instagrammUrl() {
    return this.settings.socials?.instagram;
  }

  get sliderSettings() {
    return {
      loop: true,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      breakpoints: {
        320: {
          slidesPerView: 1.5,
          slidesPerGroup: 2,
          spaceBetween: 16,
        },
        1024: {
          slidesPerView: 2.5,
          spaceBetween: 40,
          slidesPerGroup: 1,
        },
        1280: {
          slidesPerView: 3.5,
          spaceBetween: 50,
          slidesPerGroup: 1,
        },
        1440: {
          slidesPerView: 3.5,
          spaceBetween: 100,
          slidesPerGroup: 1,
        },
      },
    };
  }
}
</script>

<style lang="scss">
@media (min-width: 1280px) {
  .insta-swiper-container {
    overflow: inherit;
    height: 760px;
    .swiper-wrapper {
      align-items: flex-end !important;
    }
    .swiper-slide {
      max-height: 307px;
      height: 307px;
      transition: all 0.6s ease-in-out;
    }
    .swiper-slide-active {
      margin-bottom: 90px;
    }
    .swiper-slide-next {
      max-height: 420px;
      height: 420px;
      margin-bottom: 295px;
    }
    .swiper-slide-next + .swiper-slide-visible {
      margin-bottom: 90px;
    }
  }
}
</style>
